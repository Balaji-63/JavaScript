<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Date&Time</title>
</head>
<body>



    <script>

// LEVEL 1 – DATE TASKS
// Task 1 – Digital Clock

    function startClock() {
    function updateTime() {
        let now = new Date();

        let hours = now.getHours();
        let minutes = now.getMinutes();
        let seconds = now.getSeconds();

        let ampm = hours >= 12 ? "PM" : "AM";

        hours = hours % 12 || 12;

        hours = String(hours).padStart(2, "0");
        minutes = String(minutes).padStart(2, "0");
        seconds = String(seconds).padStart(2, "0");

        console.clear();
        console.log(`${hours} : ${minutes} : ${seconds} ${ampm}`);
    }

    updateTime();

    // Set interval ID
    let intervalId = setInterval(updateTime, 1000);

    // Stop after 10 seconds
    setTimeout(() => {
        clearInterval(intervalId);
        console.log("Clock Stopped after 10 seconds");
    }, 10000);
}

startClock();



// Task 2 – Age Calculator

let birthYear = parseInt(prompt("Enter Birth Year (YYYY):"));
let birthMonth = parseInt(prompt("Enter Birth Month (1-12):")) - 1; 
let birthDate = parseInt(prompt("Enter Birth Date (1-31):"));


let today = new Date();
let birth = new Date(birthYear, birthMonth, birthDate);

let years = today.getFullYear() - birth.getFullYear();
let months = today.getMonth() - birth.getMonth();
let days = today.getDate() - birth.getDate();


if (days < 0) {
    months--;
    let lastMonth = new Date(today.getFullYear(), today.getMonth(), 0);
    days += lastMonth.getDate();
}


if (months < 0) {
    years--;
    months += 12;
}

console.log(`You are ${years} years, ${months} months and ${days} days old.`);



// LEVEL 2 – ASYNCHRONOUS TASKS
//Task 3 – Execution Order

   console.log("Start");
   setTimeout(() => { console.log("Middle"); }, 0);
   console.log("End");

   //The output will be
   //Start
   //End
   //Middle
   //Because we have given the settimeout function for the "End" so it will be first deployed in side the call stack even thought we gave the timer foe 0ms the "End" will not be executed secondly due to the set timeout function



// Task 4 – Countdown Timer

   let count = 10;

   let interval = setInterval(() => {
    console.log(count);

    if (count === 0) {
        clearInterval(interval);
        console.log("Time's Up!");
    }

    count--;
}, 1000);



// LEVEL 3 – PROMISE TASK
//Task 5 – Custom Promise

   function checkResult(marks) {
    return new Promise((resolve, reject) => {
        if (marks >= 35) {
            resolve("Pass");
        } else {
            reject("Fail");
        }
    });
}

checkResult(50)
    .then((result) => {
        console.log("Result:", result);
    })
    .catch((error) => {
        console.log("Result:", error);
    })
    .finally(() => {
        console.log("Test Completed");
    });



// Task 6 – Promise Chain

   function step1() {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 1 Completed");
            resolve();
        }, 1000);
    });
}

function step2() {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 2 Completed");
            resolve();
        }, 1000);
    });
}

function step3() {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 3 Completed");
            resolve();
        }, 1000);
    });
}

   step1()
    .then(() => step2())
    .then(() => step3())
    .then(() => {
        console.log("All Steps Done");
    })
    .catch((error) => {
        console.log("Error:", error);
    });



// LEVEL 4 – FETCH API TASKS

   fetch("https://fakestoreapi.com/products")
  .then(response => response.json())
  .then(products => {
      // 1. Print product titles
      products.forEach((product, index) => {
          console.log( product.title);
      });

      // 2. Print total product count
      console.log(products.length);

      // 3. Print first product price
      if (products.length > 0) {
          console.log(products[0].price);
      }
  })
  .catch(error => {
      console.error("Error fetching products:", error);
  });



// Task 8 – Filter Expensive Products

   fetch("https://fakestoreapi.com/products")
  .then(response => response.json())
  .then(products => {

      let expensiveProducts = products
          .filter(product => product.price > 500)
          .map(product => ({
              title: product.title,
              price: product.price
          }));

      expensiveProducts.forEach(product => {
          console.log(`Title: ${product.title}`);
          console.log(`Price: ${product.price}`);
          console.log("------------------------");
      });

      console.log("Total Expensive Products:", expensiveProducts.length);
  })
  .catch(error => {
      console.error("Error:", error);
  });



// Task 9 – Error Handling

   fetch("https://fakestoreapi.com/productess")
  .then(response => {
      if (!response.ok) {
          throw new Error("Network response was not ok");
      }
      return response.json();
  })
  .then(data => {
      console.log(data);
  })
  .catch(error => {
      console.error("Failed to load products. Please try again.");
  });

 


    </script>



    
</body>
</html>